- [**I. H∆∞·ªõng d·∫´n m·ªü r·ªông root filesystem tr√™n Linux s·ª≠ d·ª•ng LVM**](#i-h∆∞·ªõng-d·∫´n-m·ªü-r·ªông-root-filesystem-tr√™n-linux-s·ª≠-d·ª•ng-lvm)
    - [**M·ª•c ti√™u**](#m·ª•c-ti√™u)
  - [**Th·ª±c hi·ªán m·ªü r·ªông**](#th·ª±c-hi·ªán-m·ªü-r·ªông)
    - [**1Ô∏è‚É£ Ki·ªÉm tra tr·∫°ng th√°i ·ªï ƒëƒ©a v√† ph√¢n v√πng**](#1Ô∏è‚É£-ki·ªÉm-tra-tr·∫°ng-th√°i-·ªï-ƒëƒ©a-v√†-ph√¢n-v√πng)
    - [**2Ô∏è‚É£ Kh·ªüi t·∫°o Physical Volume (PV)**](#2Ô∏è‚É£-kh·ªüi-t·∫°o-physical-volume-pv)
      - [**üîç Gi·∫£i th√≠ch c√°c th√¥ng s·ªë trong `pvs`**](#-gi·∫£i-th√≠ch-c√°c-th√¥ng-s·ªë-trong-pvs)
    - [**3Ô∏è‚É£ M·ªü r·ªông Volume Group (VG)**](#3Ô∏è‚É£-m·ªü-r·ªông-volume-group-vg)
      - [**üîç Gi·∫£i th√≠ch c√°c th√¥ng s·ªë trong `vgs`**](#-gi·∫£i-th√≠ch-c√°c-th√¥ng-s·ªë-trong-vgs)
    - [**4Ô∏è‚É£ M·ªü r·ªông Logical Volume (LV) b·∫±ng % - So s√°nh tr·ª±c quan**](#4Ô∏è‚É£-m·ªü-r·ªông-logical-volume-lv-b·∫±ng----so-s√°nh-tr·ª±c-quan)
      - [**üìå B·∫£ng so s√°nh c√°c ph∆∞∆°ng ph√°p m·ªü r·ªông LV**](#-b·∫£ng-so-s√°nh-c√°c-ph∆∞∆°ng-ph√°p-m·ªü-r·ªông-lv)
      - [**üí° Chi ti·∫øt t·ª´ng ph∆∞∆°ng ph√°p**](#-chi-ti·∫øt-t·ª´ng-ph∆∞∆°ng-ph√°p)
        - [**1Ô∏è‚É£ %FREE ‚Äì Ph·∫ßn trƒÉm dung l∆∞·ª£ng tr·ªëng c·ªßa VG**](#1Ô∏è‚É£-free--ph·∫ßn-trƒÉm-dung-l∆∞·ª£ng-tr·ªëng-c·ªßa-vg)
        - [**2Ô∏è‚É£ %VG ‚Äì Ph·∫ßn trƒÉm t·ªïng dung l∆∞·ª£ng VG**](#2Ô∏è‚É£-vg--ph·∫ßn-trƒÉm-t·ªïng-dung-l∆∞·ª£ng-vg)
        - [**3Ô∏è‚É£ %LV ‚Äì Ph·∫ßn trƒÉm so v·ªõi k√≠ch th∆∞·ªõc hi·ªán t·∫°i c·ªßa LV**](#3Ô∏è‚É£-lv--ph·∫ßn-trƒÉm-so-v·ªõi-k√≠ch-th∆∞·ªõc-hi·ªán-t·∫°i-c·ªßa-lv)
    - [**5Ô∏è‚É£ Ki·ªÉm tra lo·∫°i filesystem**](#5Ô∏è‚É£-ki·ªÉm-tra-lo·∫°i-filesystem)
      - [**üîç Gi·∫£i th√≠ch c·ªôt trong `df -T`**](#-gi·∫£i-th√≠ch-c·ªôt-trong-df--t)
    - [**6Ô∏è‚É£ M·ªü r·ªông filesystem (XFS)**](#6Ô∏è‚É£-m·ªü-r·ªông-filesystem-xfs)
    - [**7Ô∏è‚É£ Ki·ªÉm tra k·∫øt qu·∫£ cu·ªëi c√πng**](#7Ô∏è‚É£-ki·ªÉm-tra-k·∫øt-qu·∫£-cu·ªëi-c√πng)
  - [**S∆° ƒë·ªì minh h·ªça**](#s∆°-ƒë·ªì-minh-h·ªça)
    - [**1Ô∏è‚É£ S∆° ƒë·ªì Ki·∫øn tr√∫c LVM**](#1Ô∏è‚É£-s∆°-ƒë·ªì-ki·∫øn-tr√∫c-lvm)
    - [**2Ô∏è‚É£ Quy tr√¨nh t·∫°o Physical Volume**](#2Ô∏è‚É£-quy-tr√¨nh-t·∫°o-physical-volume)
    - [**3Ô∏è‚É£ M·ªü r·ªông Volume Group**](#3Ô∏è‚É£-m·ªü-r·ªông-volume-group)
    - [**4Ô∏è‚É£ S∆° ƒë·ªì lu·ªìng ho√†n ch·ªânh**](#4Ô∏è‚É£-s∆°-ƒë·ªì-lu·ªìng-ho√†n-ch·ªânh)
- [**II. L·ªô Tr√¨nh Thi·∫øt L·∫≠p MySQL Master-Slave Replication Cho Ng∆∞·ªùi M·ªõi**](#ii-l·ªô-tr√¨nh-thi·∫øt-l·∫≠p-mysql-master-slave-replication-cho-ng∆∞·ªùi-m·ªõi)
    - [**1. Gi·ªõi Thi·ªáu V√† N·ªÅn T·∫£ng MySQL Master-Slave**](#1-gi·ªõi-thi·ªáu-v√†-n·ªÅn-t·∫£ng-mysql-master-slave)
    - [**2. Chu·∫©n B·ªã M√¥i Tr∆∞·ªùng M√°y ·∫¢o**](#2-chu·∫©n-b·ªã-m√¥i-tr∆∞·ªùng-m√°y-·∫£o)
    - [**3. C√†i ƒê·∫∑t MySQL 8 Tr√™n C·∫£ Hai M√°y**](#3-c√†i-ƒë·∫∑t-mysql-8-tr√™n-c·∫£-hai-m√°y)
    - [**4. C·∫•u H√¨nh Master-Slave Replication**](#4-c·∫•u-h√¨nh-master-slave-replication)
      - [**A. C·∫•u h√¨nh Master**](#a-c·∫•u-h√¨nh-master)
      - [**B. C·∫•u h√¨nh Slave**](#b-c·∫•u-h√¨nh-slave)
    - [**5. Ki·ªÉm Th·ª≠ V√† X·ª≠ L√Ω S·ª± C·ªë**](#5-ki·ªÉm-th·ª≠-v√†-x·ª≠-l√Ω-s·ª±-c·ªë)
    - [**üí° M·∫πo Th√†nh C√¥ng**](#-m·∫πo-th√†nh-c√¥ng)

# **I. H∆∞·ªõng d·∫´n m·ªü r·ªông root filesystem tr√™n Linux s·ª≠ d·ª•ng LVM**

### **M·ª•c ti√™u**

TƒÉng dung l∆∞·ª£ng Logical Volume `ol-root` (root `/`) b·∫±ng c√°ch s·ª≠ d·ª•ng **ph·∫ßn trƒÉm dung l∆∞·ª£ng tr·ªëng**, k·∫øt h·ª£p v·ªõi ·ªï ƒëƒ©a m·ªõi `/dev/sdc`.

---

## **Th·ª±c hi·ªán m·ªü r·ªông**

### **1Ô∏è‚É£ Ki·ªÉm tra tr·∫°ng th√°i ·ªï ƒëƒ©a v√† ph√¢n v√πng**

```bash
Last login: Fri Aug  1 08:58:41 2025 from 192.168.49.1
[root@vbox ~]# lsblk
NAME              MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT
sda                 8:0    0   60G  0 disk
‚îú‚îÄsda1              8:1    0    1G  0 part /boot
‚îî‚îÄsda2              8:2    0   59G  0 part
  ‚îú‚îÄol-root       252:0    0 35.6G  0 lvm  /
  ‚îú‚îÄol-swap       252:1    0    6G  0 lvm  [SWAP]
  ‚îî‚îÄol-home       252:3    0 17.4G  0 lvm  /home
sdb                 8:16   0    1G  0 disk
‚îî‚îÄvg_data-lv_home 252:2    0  100M  0 lvm
sdc                 8:32   0  1.1G  0 disk
sr0                11:0    1 1024M  0 rom
```

‚úÖ X√°c ƒë·ªãnh ·ªï ƒëƒ©a m·ªõi `/dev/sdc` tr·ªëng v√† VG ch·ª©a root l√† `ol`.

---

### **2Ô∏è‚É£ Kh·ªüi t·∫°o Physical Volume (PV)**

```bash
[root@vbox ~]# pvcreate /dev/sdc
  Physical volume "/dev/sdc" successfully created.

[root@vbox ~]# pvs
  PV         VG      Fmt  Attr PSize    PFree
  /dev/sda2  ol      lvm2 a--   <59.00g      0
  /dev/sdb   vg_data lvm2 a--  1020.00m 920.00m
  /dev/sdc           lvm2 ---    <1.07g  <1.07g
```

#### **üîç Gi·∫£i th√≠ch c√°c th√¥ng s·ªë trong `pvs`**
| C·ªôt   | M√¥ t·∫£                                                                 |
|-------|-----------------------------------------------------------------------|
| **PV**  | T√™n Physical Volume (·ªï ƒëƒ©a v·∫≠t l√Ω ƒë√£ ƒë∆∞·ª£c LVM h√≥a)                     |
| **VG**  | T√™n Volume Group m√† PV thu·ªôc v·ªÅ (tr·ªëng = ch∆∞a thu·ªôc VG n√†o)             |
| **Fmt** | ƒê·ªãnh d·∫°ng LVM (lu√¥n l√† `lvm2` tr√™n h·ªá th·ªëng hi·ªán ƒë·∫°i)                   |
| **Attr**| Thu·ªôc t√≠nh PV:<br>`a` = allocatable (c√≥ th·ªÉ c·∫•p ph√°t),<br>`-` = kh√¥ng c√≥ t√≠nh nƒÉng ƒë·∫∑c bi·ªát |
| **PSize**| T·ªïng k√≠ch th∆∞·ªõc PV (sau khi tr·ª´ metadata LVM)                          |
| **PFree**| Dung l∆∞·ª£ng tr·ªëng tr√™n PV                                              |

‚úÖ `/dev/sdc` ƒë√£ ƒë∆∞·ª£c kh·ªüi t·∫°o th√†nh PV (ch∆∞a thu·ªôc VG n√†o).

---

### **3Ô∏è‚É£ M·ªü r·ªông Volume Group (VG)**

```bash
[root@vbox ~]# vgextend ol /dev/sdc
  Volume group "ol" successfully extended

[root@vbox ~]# vgs
  VG      #PV #LV #SN Attr   VSize    VFree
  ol        2   3   0 wz--n-   60.06g  <1.07g
  vg_data   1   1   0 wz--n- 1020.00m 920.00m
```

#### **üîç Gi·∫£i th√≠ch c√°c th√¥ng s·ªë trong `vgs`**
| C·ªôt   | M√¥ t·∫£                                                                 |
|-------|-----------------------------------------------------------------------|
| **VG**   | T√™n Volume Group                                                     |
| **#PV**  | S·ªë l∆∞·ª£ng Physical Volume trong VG                                    |
| **#LV**  | S·ªë l∆∞·ª£ng Logical Volume trong VG                                     |
| **#SN**  | S·ªë l∆∞·ª£ng snapshot (n·∫øu c√≥)                                           |
| **Attr** | Thu·ªôc t√≠nh VG:<br>`w` = writable,<br>`z` = resizable,<br>`n` = no snapshots |
| **VSize**| T·ªïng k√≠ch th∆∞·ªõc VG (sau khi c·ªông t·∫•t c·∫£ PV)                          |
| **VFree**| Dung l∆∞·ª£ng tr·ªëng trong VG                                            |

‚úÖ VG `ol` ƒë√£ tƒÉng th√™m 1 PV v√† c√≥ th√™m **~1GB dung l∆∞·ª£ng tr·ªëng**.

---

### **4Ô∏è‚É£ M·ªü r·ªông Logical Volume (LV) b·∫±ng % - So s√°nh tr·ª±c quan**

#### **üìå B·∫£ng so s√°nh c√°c ph∆∞∆°ng ph√°p m·ªü r·ªông LV**
| Ph∆∞∆°ng ph√°p | C√¥ng th·ª©c             | V√≠ d·ª• minh h·ªça (VG=60GB, Free=1GB, LV=35.61GB) | LV sau m·ªü r·ªông | VG Free sau |
|-------------|-----------------------|------------------------------------------------|----------------|-------------|
| **%FREE**   | `-l +X%FREE`          | `lvextend -l +50%FREE /dev/mapper/ol-root`     | 36.11GB (+0.5GB) | 0.5GB       |
| **%VG**     | `-l X%VG`             | `lvextend -l 80%VG /dev/mapper/ol-root`        | 48GB           | 12GB*       |
| **%LV**     | `-L +X%LV`            | `lvextend -L +20%LV /dev/mapper/ol-root`       | 42.73GB (+7.12GB) | 0GB**       |

> **\* L∆∞u √Ω:**  
> - **%VG 80%** = 80% t·ªïng dung l∆∞·ª£ng VG (60GB √ó 0.8 = 48GB).  
> - **%LV 20%** ch·ªâ th√†nh c√¥ng n·∫øu VG c√≥ ƒë·ªß dung l∆∞·ª£ng tr·ªëng (trong v√≠ d·ª• n√†y c·∫ßn 7.12GB nh∆∞ng ch·ªâ c√≥ 1GB ‚Üí **th·∫•t b·∫°i**).  
> - **%FREE 50%** lu√¥n an to√†n v√¨ ch·ªâ s·ª≠ d·ª•ng dung l∆∞·ª£ng tr·ªëng hi·ªán c√≥.

---

#### **üí° Chi ti·∫øt t·ª´ng ph∆∞∆°ng ph√°p**

##### **1Ô∏è‚É£ %FREE ‚Äì Ph·∫ßn trƒÉm dung l∆∞·ª£ng tr·ªëng c·ªßa VG**
```bash
lvextend -l +100%FREE /dev/mapper/ol-root
```
- **C√¥ng th·ª©c**: `+X%FREE` = TƒÉng th√™m **X%** c·ªßa dung l∆∞·ª£ng tr·ªëng trong VG.
- **V√≠ d·ª•**:  
  VG `ol` c√≤n tr·ªëng **1GB** ‚Üí `+100%FREE` = TƒÉng th√™m **1GB** cho LV.
- **∆Øu ƒëi·ªÉm**: Lu√¥n ƒë·∫£m b·∫£o kh√¥ng v∆∞·ª£t qu√° dung l∆∞·ª£ng tr·ªëng.

---

##### **2Ô∏è‚É£ %VG ‚Äì Ph·∫ßn trƒÉm t·ªïng dung l∆∞·ª£ng VG**
```bash
lvextend -l 80%VG /dev/mapper/ol-root
```
- **C√¥ng th·ª©c**: `X%VG` = ƒê·∫∑t k√≠ch th∆∞·ªõc LV b·∫±ng **X%** t·ªïng dung l∆∞·ª£ng VG.
- **V√≠ d·ª•**:  
  VG `ol` c√≥ t·ªïng **60GB** ‚Üí `80%VG` = LV s·∫Ω chi·∫øm **48GB** (d√π ƒëang ·ªü m·ª©c bao nhi√™u).
- **C·∫£nh b√°o**: C√≥ th·ªÉ th·∫•t b·∫°i n·∫øu VG kh√¥ng ƒë·ªß dung l∆∞·ª£ng tr·ªëng.

---

##### **3Ô∏è‚É£ %LV ‚Äì Ph·∫ßn trƒÉm so v·ªõi k√≠ch th∆∞·ªõc hi·ªán t·∫°i c·ªßa LV**
```bash
lvextend -L +20%LV /dev/mapper/ol-root
```
- **C√¥ng th·ª©c**: `+X%LV` = TƒÉng th√™m **X%** k√≠ch th∆∞·ªõc LV hi·ªán t·∫°i.
- **V√≠ d·ª•**:  
  LV `ol-root` ƒëang l√† **35.61GB** ‚Üí `+20%LV` = TƒÉng th√™m **7.12GB** (35.61 √ó 0.2).
- **H·∫°n ch·∫ø**: D·ªÖ th·∫•t b·∫°i n·∫øu VG kh√¥ng ƒë·ªß dung l∆∞·ª£ng tr·ªëng.

---

### **5Ô∏è‚É£ Ki·ªÉm tra lo·∫°i filesystem**

```bash
[root@vbox ~]# df -T /
Filesystem          Type 1K-blocks    Used Available Use% Mounted on
/dev/mapper/ol-root xfs   37320904 8510184  28810720  23% /
```

#### **üîç Gi·∫£i th√≠ch c·ªôt trong `df -T`**
| C·ªôt          | M√¥ t·∫£                                                                 |
|--------------|-----------------------------------------------------------------------|
| **Filesystem**| Thi·∫øt b·ªã ho·∫∑c mount point                                            |
| **Type**      | Lo·∫°i filesystem (XFS, ext4, btrfs, v.v.)                              |
| **1K-blocks** | T·ªïng s·ªë block 1KB                                                     |
| **Used**      | Dung l∆∞·ª£ng ƒë√£ d√πng                                                   |
| **Available** | Dung l∆∞·ª£ng tr·ªëng                                                     |
| **Use%**      | Ph·∫ßn trƒÉm s·ª≠ d·ª•ng                                                    |
| **Mounted on**| ƒêi·ªÉm mount                                                           |

> **üí° Ch√∫ th√≠ch:**
>
> * V·ªõi **ext4**, m·ªü r·ªông filesystem d√πng:
>
>   ```bash
>   resize2fs /dev/mapper/ol-root
>   ```
>
>   (c√≥ th·ªÉ ch·ªâ ƒë·ªãnh tr·ª±c ti·∫øp block device ho·∫∑c mount point).
> * V·ªõi **XFS**, b·∫Øt bu·ªôc d√πng:
>
>   ```bash
>   xfs_growfs /
>   ```
>
>   (ch·ªâ d√πng **mount point**, v√¨ XFS ch·ªâ h·ªó tr·ª£ m·ªü r·ªông **online** tr√™n filesystem ƒëang mount).

---

### **6Ô∏è‚É£ M·ªü r·ªông filesystem (XFS)**

```bash
[root@vbox ~]# xfs_growfs /
meta-data=/dev/mapper/ol-root    isize=512    agcount=4, agsize=2333696 blks
         =                       sectsz=512   attr=2, projid32bit=1
         =                       crc=1        finobt=1, sparse=1, rmapbt=0
         =                       reflink=1    bigtime=0 inobtcount=0
data     =                       bsize=4096   blocks=9334784, imaxpct=25
         =                       sunit=0      swidth=0 blks
naming   =version 2              bsize=4096   ascii-ci=0, ftype=1
log      =internal log           bsize=4096   blocks=4558, version=2
         =                       sectsz=512   sunit=0 blks, lazy-count=1
realtime =none                   extsz=4096   blocks=0, rtextents=0
data blocks changed from 9334784 to 9596928
```

‚úÖ Filesystem ƒë√£ ƒë∆∞·ª£c m·ªü r·ªông v√† nh·∫≠n di·ªán dung l∆∞·ª£ng m·ªõi.

> **üí° Ch√∫ th√≠ch:** V·ªõi **XFS**, l·ªánh `xfs_growfs` lu√¥n y√™u c·∫ßu **mount point** (v√≠ d·ª• `/`), **kh√¥ng ch·ªâ ƒë·ªãnh tr·ª±c ti·∫øp block device** nh∆∞ `/dev/mapper/ol-root`.
> ƒêi·ªÅu n√†y v√¨ XFS h·ªó tr·ª£ m·ªü r·ªông **online** v√† thao t√°c n√†y ch·ªâ h·ª£p l·ªá khi filesystem ƒëang ƒë∆∞·ª£c mount.


---

### **7Ô∏è‚É£ Ki·ªÉm tra k·∫øt qu·∫£ cu·ªëi c√πng**

```bash
[root@vbox ~]# df -h
Filesystem           Size  Used Avail Use% Mounted on
/dev/mapper/ol-root   37G  8.2G   29G  23% /
/dev/mapper/ol-home   18G  158M   18G   1% /home
/dev/sda1           1014M  680M  335M  67% /boot
```

‚úÖ Root filesystem tƒÉng t·ª´ **36GB ‚Üí 37GB**, m·ªü r·ªông th√†nh c√¥ng.

---

## **S∆° ƒë·ªì minh h·ªça**

### **1Ô∏è‚É£ S∆° ƒë·ªì Ki·∫øn tr√∫c LVM**

```mermaid
graph TD
    subgraph "·ªî ƒëƒ©a v·∫≠t l√Ω"
        A("·ªî ƒëƒ©a 1<br/>/dev/sda2"):::disk1
        B("·ªî ƒëƒ©a 2<br/>/dev/sdb1"):::disk2
        C("·ªî ƒëƒ©a m·ªõi<br/>/dev/sdc"):::disk_new
    end

    subgraph "LVM Layer"
        PV1["PV<br/>/dev/sda2"]:::pv1
        PV2["PV<br/>/dev/sdb1"]:::pv2
        PV_New["PV<br/>/dev/sdc"]:::pv_new

        VG(("Volume Group<br/>ol")):::vg

        LV1["/root"]:::lv_root
        LV2["/home"]:::lv_home
        LV3["swap"]:::lv_swap
    end

    A --> PV1
    B --> PV2
    C --> PV_New

    PV1 --> VG
    PV2 --> VG
    PV_New --> VG

    VG --> LV1
    VG --> LV2
    VG --> LV3

    classDef disk1 fill:#FF6B6B,stroke:#E55353,stroke-width:4px,color:#FFFFFF
    classDef disk2 fill:#4ECDC4,stroke:#45B7B8,stroke-width:4px,color:#FFFFFF
    classDef disk_new fill:#45B7D1,stroke:#3498DB,stroke-width:4px,color:#FFFFFF
    
    classDef pv1 fill:#96CEB4,stroke:#78B198,stroke-width:4px,color:#2C3E50
    classDef pv2 fill:#FFEAA7,stroke:#FDCB6E,stroke-width:4px,color:#2C3E50
    classDef pv_new fill:#DDA0DD,stroke:#DA70D6,stroke-width:4px,color:#FFFFFF
    
    classDef vg fill:#A29BFE,stroke:#6C5CE7,stroke-width:5px,color:#FFFFFF
    
    classDef lv_root fill:#FD79A8,stroke:#E84393,stroke-width:4px,color:#FFFFFF
    classDef lv_home fill:#00B894,stroke:#00A085,stroke-width:4px,color:#FFFFFF
    classDef lv_swap fill:#FDCB6E,stroke:#E17055,stroke-width:4px,color:#FFFFFF
```

---

### **2Ô∏è‚É£ Quy tr√¨nh t·∫°o Physical Volume**

```mermaid
stateDiagram-v2
    direction LR
    
    state "·ªî ƒëƒ©a th√¥" as Unmanaged {
        state "/dev/sdc<br/>Kh√¥ng qu·∫£n l√Ω<br/>Tr·∫°ng th√°i g·ªëc" as RawDisk
        [*] --> RawDisk
    }
    
    state "Kh·ªüi t·∫°o" as Creating {
        state "ƒêang x·ª≠ l√Ω<br/>Chu·∫©n b·ªã kh·ªüi t·∫°o" as Processing
        state "ƒê·ªãnh d·∫°ng<br/>T·∫°o c·∫•u tr√∫c LVM" as Formatting  
        state "T·∫°o LVM metadata<br/>Ho√†n t·∫•t kh·ªüi t·∫°o" as MetadataCreation
        
        [*] --> Processing
        Processing --> Formatting
        Formatting --> MetadataCreation
    }
    
    state "Physical Volume" as PV {
        state "ƒê√£ s·∫µn s√†ng<br/>PV ƒë∆∞·ª£c t·∫°o th√†nh c√¥ng" as PVReady
        state "S·∫µn s√†ng th√™m v√†o VG<br/>C√≥ th·ªÉ c·∫•p ph√°t" as PVAvailable
        
        [*] --> PVReady
        PVReady --> PVAvailable
    }

    [*] --> Unmanaged
    Unmanaged --> Creating : pvcreate /dev/sdc
    Creating --> PV : Th√†nh c√¥ng
    
    note right of PV
        Tr·∫°ng th√°i: PV ƒë√£ s·∫µn s√†ng
        Dung l∆∞·ª£ng: ~1.07G
        Qu·∫£n l√Ω: C√≥ th·ªÉ qu·∫£n l√Ω b·ªüi LVM
    end note

    classDef unmanaged fill:#FF7675,stroke:#D63031,stroke-width:2px,color:#FFFFFF
    classDef creating fill:#FDCB6E,stroke:#E17055,stroke-width:2px,color:#2D3436
    classDef pv fill:#00B894,stroke:#00A085,stroke-width:2px,color:#FFFFFF
    
    class Unmanaged unmanaged
    class Creating creating
    class PV pv
```

---

### **3Ô∏è‚É£ M·ªü r·ªông Volume Group**

```mermaid
graph TD
    subgraph "Tr∆∞·ªõc khi m·ªü r·ªông"
        VG_before(("VG ol<br/>59G<br/>0G Free")):::vg_before
        PV1["PV /dev/sda2<br/>59G"]:::pv1 --> VG_before
    end

    PV_New("PV /dev/sdc<br/>~1G<br/>Ch∆∞a thu·ªôc VG"):::pv_new

    subgraph "Sau khi m·ªü r·ªông"
        VG_after(("VG ol<br/>60G<br/>1G Free")):::vg_after
        PV1_after["PV /dev/sda2<br/>59G"]:::pv1_after --> VG_after
        PV_New_after["PV /dev/sdc<br/>~1G"]:::pv_new_after --> VG_after
    end

    PV_New -.->|"vgextend ol /dev/sdc"| VG_after

    classDef pv1 fill:#FF6B9D,stroke:#C44569,stroke-width:4px,color:#FFFFFF
    classDef pv1_after fill:#FF6B9D,stroke:#C44569,stroke-width:4px,color:#FFFFFF
    classDef pv_new fill:#A8E6CF,stroke:#7FCDCD,stroke-width:4px,color:#2C3E50
    classDef pv_new_after fill:#FFD93D,stroke:#FFC312,stroke-width:4px,color:#2C3E50
    classDef vg_before fill:#FF8A80,stroke:#F44336,stroke-width:4px,color:#FFFFFF
    classDef vg_after fill:#81C784,stroke:#4CAF50,stroke-width:5px,color:#FFFFFF
```

### **4Ô∏è‚É£ S∆° ƒë·ªì lu·ªìng ho√†n ch·ªânh**

```mermaid
sequenceDiagram
    participant U as User (root)
    participant OS as Linux OS
    participant LVM as LVM Manager
    participant FS as Filesystem (XFS)

    autonumber
    
    Note over U,FS: Giai ƒëo·∫°n kh·∫£o s√°t h·ªá th·ªëng
    U->>+OS: lsblk, pvs, vgs
    OS-->>-U: Hi·ªÉn th·ªã c·∫•u tr√∫c ƒëƒ©a hi·ªán t·∫°i
    
    Note over U,FS: Giai ƒëo·∫°n kh·ªüi t·∫°o PV
    U->>+LVM: pvcreate /dev/sdc
    LVM-->>-U: Physical Volume created
    
    Note over U,FS: Giai ƒëo·∫°n m·ªü r·ªông VG
    U->>+LVM: vgextend ol /dev/sdc
    LVM-->>-U: Volume Group extended (+1.07G)
    
    Note over U,FS: Giai ƒëo·∫°n m·ªü r·ªông LV
    U->>+LVM: lvextend -l +100%FREE /dev/mapper/ol-root
    LVM-->>-U: Logical Volume resized
    
    Note over U,FS: Giai ƒëo·∫°n ki·ªÉm tra filesystem
    U->>+OS: df -T /
    OS-->>-U: Filesystem type: 'xfs'
    
    Note over U,FS: Giai ƒëo·∫°n ƒë·ªìng b·ªô filesystem
    U->>+FS: xfs_growfs /
    FS-->>-U: Filesystem expanded to new size
    
    Note over U,FS: Giai ƒëo·∫°n x√°c nh·∫≠n k·∫øt qu·∫£
    U->>+OS: df -h
    OS-->>-U: Hi·ªÉn th·ªã dung l∆∞·ª£ng m·ªõi: 37G
```

---

# **II. L·ªô Tr√¨nh Thi·∫øt L·∫≠p MySQL Master-Slave Replication Cho Ng∆∞·ªùi M·ªõi**


### **1. Gi·ªõi Thi·ªáu V√† N·ªÅn T·∫£ng MySQL Master-Slave**  
üéØ **M·ª•c ti√™u**: Hi·ªÉu b·∫£n ch·∫•t m√¥ h√¨nh, nguy√™n l√Ω ho·∫°t ƒë·ªông v√† tr∆∞·ªùng h·ª£p ·ª©ng d·ª•ng.  

**N·ªôi dung h·ªçc**:  
1. üêò **Master-Slave l√† g√¨?**  
   - **Kh√°i ni·ªám**: Master ghi thay ƒë·ªïi ‚Üí Slave sao ch√©p d·ªØ li·ªáu t·ª´ Master (1 chi·ªÅu)  
   - **Nguy√™n l√Ω**: S·ª≠ d·ª•ng Binary Log (Master) ‚Üí Relay Log (Slave) ‚Üí SQL Thread √°p d·ª•ng thay ƒë·ªïi  
   - **So s√°nh ƒë∆°n gi·∫£n**:  
     - *Master*: X·ª≠ l√Ω **INSERT/UPDATE/DELETE** (ghi d·ªØ li·ªáu)  
     - *Slave*: Ch·ªâ **SELECT** (ƒë·ªçc d·ªØ li·ªáu, ph·ª•c v·ª• scale ·ª©ng d·ª•ng)  

2. üåü **L·ª£i √≠ch & Gi·ªõi h·∫°n**:  
   - ‚úÖ *L·ª£i √≠ch*: TƒÉng kh·∫£ nƒÉng ƒë·ªçc, sao l∆∞u an to√†n, disaster recovery  
   - ‚ùå *Gi·ªõi h·∫°n*: Slave **kh√¥ng th·ªÉ ghi**, ƒë·ªô tr·ªÖ ƒë·ªìng b·ªô (latency), ch·ªâ ch·ªëng l·ªói cho read workload  

3. üîß **Th√†nh ph·∫ßn c·ªët l√µi**:  
   - **Binary Log**: Ghi l·∫°i m·ªçi thay ƒë·ªïi tr√™n Master  
   - **I/O Thread**: Slave k·∫øt n·ªëi Master ƒë·ªÉ l·∫•y Binary Log  
   - **SQL Thread**: √Åp d·ª•ng thay ƒë·ªïi t·ª´ Relay Log v√†o Slave  

üìù **B√†i t·∫≠p th·ª±c h√†nh**:  
   - V·∫Ω s∆° ƒë·ªì ho·∫°t ƒë·ªông Master-Slave tr√™n gi·∫•y  
   - T√¨m 3 ·ª©ng d·ª•ng th·ª±c t·∫ø d√πng m√¥ h√¨nh n√†y (v√≠ d·ª•: website c√≥ traffic ƒë·ªçc cao)  
   - ƒê·ªçc [MySQL Replication Documentation](https://dev.mysql.com/doc/refman/8.0/en/replication.html)  

üìö **T√†i nguy√™n h·ªçc t·∫≠p**:  
   - Video: "MySQL Replication Explained in 5 Minutes" (YouTube)  
   - Infographic: [How MySQL Replication Works](https://www.percona.com/blog/2019/08/20/how-mysql-replication-works/)  

---

### **2. Chu·∫©n B·ªã M√¥i Tr∆∞·ªùng M√°y ·∫¢o**  
üéØ **M·ª•c ti√™u**: Thi·∫øt l·∫≠p 2 m√°y ·∫£o (Master/Slave) k·∫øt n·ªëi m·∫°ng ·ªïn ƒë·ªãnh.  

**N·ªôi dung h·ªçc**:  
1. üñ• **Ch·ªçn c√¥ng c·ª• ·∫£o h√≥a**:  
   - **Khuy·∫øn ngh·ªã**: VirtualBox (gi·ªëng l·ªô tr√¨nh Linux) ho·∫∑c VMware Workstation Player  
   - T·∫°i sao kh√¥ng d√πng cloud? ‚Üí T·∫≠p trung v√†o nguy√™n l√Ω, tr√°nh ph√≠ t·ªïn  

2. üíª **C·∫•u h√¨nh m√°y ·∫£o**:  
   - **H·ªá ƒëi·ªÅu h√†nh**: Ubuntu 22.04 LTS (c√πng distro ƒë√£ h·ªçc)  
   - **Th√¥ng s·ªë t·ªëi thi·ªÉu**:  
     | M√°y       | RAM  | CPU | ·ªî c·ª©ng |  
     |-----------|------|-----|--------|  
     | **Master**| 1GB  | 1   | 10GB   |  
     | **Slave** | 1GB  | 1   | 10GB   |  

3. üåê **C·∫•u h√¨nh m·∫°ng**:  
   - **Network Mode**: Internal Network (VirtualBox) ho·∫∑c NAT Network  
   - **IP tƒ©nh v√≠ d·ª•**:  
     - Master: `192.168.56.10`  
     - Slave: `192.168.56.11`  
   - **B·∫Øt bu·ªôc**:  
     - ƒê·∫∑t hostname: `sudo hostnamectl set-hostname mysql-master`  
     - C·∫•u h√¨nh `/etc/hosts` tr√™n c·∫£ 2 m√°y:  
       ```bash
       192.168.56.10 mysql-master
       192.168.56.11 mysql-slave
       ```  
   - **Ki·ªÉm tra**: `ping mysql-master` t·ª´ Slave v√† ng∆∞·ª£c l·∫°i  

üìù **B√†i t·∫≠p th·ª±c h√†nh**:  
   - T·∫°o 2 m√°y ·∫£o Ubuntu tr√™n VirtualBox  
   - C·∫•u h√¨nh IP tƒ©nh v√† hostname nh∆∞ h∆∞·ªõng d·∫´n  
   - ƒê·∫£m b·∫£o 2 m√°y **ping ƒë∆∞·ª£c nhau** v√† **truy c·∫≠p internet**  
   - Ch·ª•p ·∫£nh m√†n h√¨nh k·∫øt qu·∫£ ki·ªÉm tra m·∫°ng  

üìö **T√†i nguy√™n h·ªçc t·∫≠p**:  
   - [H∆∞·ªõng d·∫´n c·∫•u h√¨nh m·∫°ng VirtualBox](https://www.virtualbox.org/manual/ch06.html)  
   - Cheat sheet: `ip a`, `sudo nano /etc/netplan/00-config.yaml`  

---

### **3. C√†i ƒê·∫∑t MySQL 8 Tr√™n C·∫£ Hai M√°y**  
üéØ **M·ª•c ti√™u**: C√†i ƒë·∫∑t MySQL 8 v√† thi·∫øt l·∫≠p b·∫£o m·∫≠t c∆° b·∫£n.  

**N·ªôi dung h·ªçc**:  
1. üì¶ **C√†i ƒë·∫∑t MySQL 8**:  
   ```bash
   # Tr√™n c·∫£ 2 m√°y
   sudo apt update
   sudo apt install mysql-server -y
   sudo mysql_secure_installation  # Thi·∫øt l·∫≠p m·∫≠t kh·∫©u root, lo·∫°i b·ªè user ·∫©n danh
   ```

2. üîê **B·∫£o m·∫≠t c·∫ßn thi·∫øt**:  
   - M·ªü port 3306: `sudo ufw allow 3306/tcp`  
   - S·ª≠a file c·∫•u h√¨nh:  
     ```bash
     sudo nano /etc/mysql/mysql.conf.d/mysqld.cnf
     ```
     - **T·∫Øt bind-address** (cho ph√©p k·∫øt n·ªëi t·ª´ m·∫°ng):  
       ```ini
       # Comment d√≤ng sau:
       # bind-address = 127.0.0.1
       ```

3. üß™ **Ki·ªÉm tra c√†i ƒë·∫∑t**:  
   ```bash
   sudo systemctl status mysql    # X√°c nh·∫≠n service ƒëang ch·∫°y
   mysql -u root -p -e "SHOW VARIABLES LIKE 'version';"  # Ki·ªÉm tra phi√™n b·∫£n
   ```

üìù **B√†i t·∫≠p th·ª±c h√†nh**:  
   - C√†i MySQL 8 tr√™n c·∫£ Master v√† Slave  
   - T·∫°o database `test_db` v√† table `users` tr√™n Master  
   - ƒê·∫£m b·∫£o **kh√¥ng th·ªÉ k·∫øt n·ªëi t·ª´ Slave sang Master** (ki·ªÉm tra b·∫±ng `telnet mysql-master 3306`)  
   - Ghi ch√∫ l·∫°i l·ªói g·∫∑p ph·∫£i v√† c√°ch kh·∫Øc ph·ª•c  

üìö **T√†i nguy√™n h·ªçc t·∫≠p**:  
   - [MySQL 8 Installation Guide](https://dev.mysql.com/doc/mysql-installation-excerpt/8.0/en/)  
   - Video: "Fix MySQL Connection Refused Error"  

---

### **4. C·∫•u H√¨nh Master-Slave Replication**  
üéØ **M·ª•c ti√™u**: ƒê·ªìng b·ªô d·ªØ li·ªáu t·ª´ Master sang Slave th√†nh c√¥ng.  

**N·ªôi dung h·ªçc**:  
#### **A. C·∫•u h√¨nh Master**  
1. ‚úèÔ∏è **S·ª≠a file config**:  
   ```ini
   # /etc/mysql/mysql.conf.d/mysqld.cnf
   server-id = 1
   log_bin = /var/log/mysql/mysql-bin.log
   binlog_do_db = test_db  # Ch·ªâ ƒë·ªìng b·ªô database n√†y (t√πy ch·ªçn)
   ```

2. üîë **T·∫°o user replication**:  
   ```sql
   CREATE USER 'repl'@'%' IDENTIFIED BY 'SecurePass123!';
   GRANT REPLICATION SLAVE ON *.* TO 'repl'@'%';
   FLUSH PRIVILEGES;
   ```

3. üìä **L·∫•y tr·∫°ng th√°i Master**:  
   ```sql
   FLUSH TABLES WITH READ LOCK;
   SHOW MASTER STATUS;  -- Ghi l·∫°i File v√† Position (v√≠ d·ª•: mysql-bin.000003 | 1000)
   ```

#### **B. C·∫•u h√¨nh Slave**  
1. ‚úèÔ∏è **S·ª≠a file config**:  
   ```ini
   # /etc/mysql/mysql.conf.d/mysqld.cnf
   server-id = 2
   relay_log = /var/log/mysql/mysql-relay-bin.log
   read_only = ON
   ```

2. üîÑ **K·∫øt n·ªëi Slave v·ªõi Master**:  
   ```sql
   CHANGE MASTER TO
     MASTER_HOST='mysql-master',
     MASTER_USER='repl',
     MASTER_PASSWORD='SecurePass123!',
     MASTER_LOG_FILE='mysql-bin.000003',
     MASTER_LOG_POS=1000;
   START SLAVE;
   ```

3. üîç **Ki·ªÉm tra tr·∫°ng th√°i**:  
   ```sql
   SHOW SLAVE STATUS\G
   -- ƒê·∫£m b·∫£o 2 gi√° tr·ªã sau = "Yes":
   Slave_IO_Running: Yes
   Slave_SQL_Running: Yes
   ```

üìù **B√†i t·∫≠p th·ª±c h√†nh**:  
   - Th·ª±c hi·ªán t·ª´ng b∆∞·ªõc c·∫•u h√¨nh tr√™n Master/Slave  
   - Ghi l·∫°i **File** v√† **Position** t·ª´ `SHOW MASTER STATUS`  
   - T·∫°o 1 b·∫£n ghi tr√™n Master: `INSERT INTO test_db.users VALUES (1, 'Test');`  
   - Ki·ªÉm tra b·∫£n ghi tr√™n Slave ‚Üí B√°o c√°o k·∫øt qu·∫£  
   - **Th·ª≠ th√°ch**: T·∫°m d·ª´ng replication b·∫±ng `STOP SLAVE;` v√† ti·∫øp t·ª•c sau 5 ph√∫t  

üìö **T√†i nguy√™n h·ªçc t·∫≠p**:  
   - [MySQL Replication Setup Guide](https://dev.mysql.com/doc/refman/8.0/en/replication-configuration.html)  
   - Tool: [MySQL Replication Checker](https://github.com/mysql/mysql-shell)  

---

### **5. Ki·ªÉm Th·ª≠ V√† X·ª≠ L√Ω S·ª± C·ªë**  
üéØ **M·ª•c ti√™u**: X√°c minh h·ªá th·ªëng ho·∫°t ƒë·ªông ·ªïn ƒë·ªãnh v√† kh·∫Øc ph·ª•c l·ªói c∆° b·∫£n.  

**N·ªôi dung h·ªçc**:  
1. üß™ **Test ƒë·ªìng b·ªô**:  
   - T·∫°o database m·ªõi tr√™n Master ‚Üí Ki·ªÉm tra tr√™n Slave  
   - X√≥a b·∫£n ghi tr√™n Master ‚Üí X√°c nh·∫≠n Slave t·ª± ƒë·ªông c·∫≠p nh·∫≠t  

2. ‚ö†Ô∏è **L·ªói th∆∞·ªùng g·∫∑p & C√°ch fix**:  
   | L·ªói                          | Nguy√™n nh√¢n               | Gi·∫£i ph√°p                  |  
   |------------------------------|---------------------------|----------------------------|  
   | `Slave_IO_Running: No`       | Network/firewall          | M·ªü port 3306, ki·ªÉm tra ping |  
   | `Error 1045`                 | Sai m·∫≠t kh·∫©u replication  | T·∫°o l·∫°i user tr√™n Master   |  
   | `Duplicate entry`            | Xung ƒë·ªôt d·ªØ li·ªáu          | Ch·∫°y `STOP SLAVE; SET GLOBAL sql_slave_skip_counter=1; START SLAVE;` |  

3. üìà **Theo d√µi hi·ªáu nƒÉng**:  
   ```sql
   SHOW SLAVE STATUS\G  -- Xem Seconds_Behind_Master
   ```

üìù **B√†i t·∫≠p th·ª±c h√†nh**:  
   - G√¢y l·ªói **c·ªë √Ω** (v√≠ d·ª•: s·ª≠a `server-id` tr√πng nhau) v√† kh·∫Øc ph·ª•c  
   - ƒêo th·ªùi gian ƒë·ªìng b·ªô v·ªõi 1.000 b·∫£n ghi ch√®n v√†o Master  
   - Vi·∫øt script t·ª± ƒë·ªông ki·ªÉm tra tr·∫°ng th√°i replication m·ªói 5 ph√∫t  

üìö **T√†i nguy√™n h·ªçc t·∫≠p**:  
   - [MySQL Replication Troubleshooting](https://dev.mysql.com/doc/refman/8.0/en/replication-problems.html)  
   - Tool: `mytop` (monitor replication real-time)  

---

### **üí° M·∫πo Th√†nh C√¥ng**  
1. **Backup tr∆∞·ªõc khi c·∫•u h√¨nh**: `mysqldump -u root -p --all-databases > backup.sql`  
2. **D√πng m·∫≠t kh·∫©u m·∫°nh** cho user replication (tr√°nh `password123`)  
3. **Ki·ªÉm tra log** khi g·∫∑p l·ªói: `sudo tail -f /var/log/mysql/error.log`  
4. **Lu√¥n reset replication** khi thay ƒë·ªïi c·∫•u h√¨nh:  
   ```sql
   -- Tr√™n Slave
   STOP SLAVE;
   RESET SLAVE ALL;
   ```  
